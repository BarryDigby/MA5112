q()
log_assoc_covar<- read.table("/home/lukec/Documents/MA5106/plink.assoc.logistic", header=T)
log_assoc_nocovar<-read.table("/home/lukec/Documents/MA5106/log_nocovar.assoc.logistic", header=T)
manhattan(log_assoc_covar, ylim=c(0,25), main="Manhattan plot of logistic regresssion (age and sex covariates)", xlab="Chromosomes", col=c("red", "blue"), annotatePval=0.00000005)
install.packages("qqman")
miss_i<- read.table("/home/lukec/Documents/MA5106/miss_stat.imiss", header=T)
miss_l<- read.table("/home/lukec/Documents/MA5106/miss_stat.lmiss", header=T)
par(mfrow=c(1,2))
imiss_f_hist<-hist(miss_i$F_MISS, breaks=seq(0.015,0.018, by=0.00002),main ="Missing SNP distribution", xlab="Proportion of missing SNPs per individual", ylab="Number of individuals")
imiss_n_hist<-hist(miss_i$N_MISS, breaks=seq(4800,5400, by=5), main="Missing SNP distribution", xlab="Number of SNPs missing per individual", ylab="Number of individuals")
lmiss_n_hist<-hist(miss_l$N_MISS, breaks=seq(0,400,by=1), main ="Missing SNP distribution", xlab="Number of individuals missing SNP", ylab="Number of SNPs")
lmiss_f_hist<-hist(miss_l$F_MISS,breaks=seq(0,0.1,by=0.0001), main="Missing SNP distribution", xlab="Proportion of missing SNPs", ylab="Number of SNPs")
freq_stat<- read.table("/home/lukec/Documents/MA5106/freq_stat.frq", header=T)
freq_stat_hist<- hist(freq_stat$MAF,breaks=seq(0.01,0.51,by=0.0001), main="Minor allele frequency distribution", xlab="Proportion of MAF", ylab="Number of SNPs")
assoc1<- read.table("/home/lukec/Documents/MA5106/assoc1.assoc.adjusted", header=T)
assoc_p<- data.frame(assoc1$SNP ,assoc1$BONF, assoc1$HOLM, assoc1$SIDAK_SS, assoc1$SIDAK_SD, assoc1$FDR_BH, assoc1$FDR_BY)
colnames(assoc_p)<-c("SNP","BONF","HOLM","SIDAK_SS","SIDAK_SD","FDR_BH","FDR_BY")
assoc_sigp<- subset(assoc_p, select=c(SNP, BONF, HOLM, SIDAK_SS, SIDAK_SD, FDR_BH, FDR_BY), assoc_p$BONF<0.05, assoc_p$HOLM<0.05, assoc_p$SIDAK_SS<0.05, assoc_p$SIDAK_SD<0.05, assoc_p$FDR_BH<0.05, assoc_p$FDR_BY<0.05, drop=FALSE)
assoc_sigp
log_assoc_covar<- read.table("/home/lukec/Documents/MA5106/plink.assoc.logistic", header=T)
log_assoc_nocovar<-read.table("/home/lukec/Documents/MA5106/log_nocovar.assoc.logistic", header=T)
manhattan(log_assoc_covar, ylim=c(0,25), main="Manhattan plot of logistic regresssion (age and sex covariates)", xlab="Chromosomes", col=c("red", "blue"), annotatePval=0.00000005)
install.packages("qqman")
log_assoc_covar<- read.table("/home/lukec/Documents/MA5106/plink.assoc.logistic", header=T)
log_assoc_nocovar<-read.table("/home/lukec/Documents/MA5106/log_nocovar.assoc.logistic", header=T)
manhattan(log_assoc_covar, ylim=c(0,25), main="Manhattan plot of logistic regresssion (age and sex covariates)", xlab="Chromosomes", col=c("red", "blue"), annotatePval=0.00000005)
install.packages("qqman")
library(qqman)
install.packages("qqman")
library(qqman)
log_assoc_covar<- read.table("/home/lukec/Documents/MA5106/plink.assoc.logistic", header=T)
log_assoc_nocovar<-read.table("/home/lukec/Documents/MA5106/log_nocovar.assoc.logistic", header=T)
manhattan(log_assoc_covar, ylim=c(0,25), main="Manhattan plot of logistic regresssion (age and sex covariates)", xlab="Chromosomes", col=c("red", "blue"), annotatePval=0.00000005)
manhattan(log_assoc_nocovar, ylim=c(0,25), main="Manhattan plot of logistic regression (no covariates)", xlab="Chromomosomes", col=c("blue", "red"), annotatePval=0.00000005)
library(qqman)
log_assoc_covar<- read.table("/home/lukec/Documents/MA5106/plink.assoc.logistic", header=T)
log_assoc_nocovar<-read.table("/home/lukec/Documents/MA5106/log_nocovar.assoc.logistic", header=T)
manhattan(log_assoc_covar, ylim=c(0,25), main="Manhattan plot of logistic regresssion (age and sex covariates)", xlab="Chromosomes", col=c("red", "blue"), annotatePval=0.00000005)
manhattan(log_assoc_nocovar, ylim=c(0,25), main="Manhattan plot of logistic regression (no covariates)", xlab="Chromomosomes", col=c("blue", "red"), annotatePval=0.00000005)
p_val_qq<-c(log_assoc_covar$P)
qq(p_val_qq)
qq(p_val_qq, main="Q-Q plot of GWAS p-values")
p_val_qq<-c(log_assoc_covar$P)
qq(p_val_qq, main="Q-Q plot of GWAS p-values")
p_val_qq<-c(log_assoc_covar$P)
qq(p_val_qq, main="Q-Q plot of GWAS p-values")
library(knitr)
install.packages("formatR")
save.image("~/Documents/MA5106/gwas_env.RData")
library(formatR)
pbinom(200,7,0.1)
pbinom(7,200,0.1)
dbinom(7,200,0.1)
dbinom(7,200,0.1)
dbinom(6,200,0.1)
dbinom(5,200,0.1)
m4<-matrix(c(0.3,0.2,0.3,0.1,0.3,0.4,0.1,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.6),nrow=4)
m4
ev4<-eigen(t(m4))
ev4
v4<-ev4$vectors[,1]
v4
v4/sum(v4)
m4<-matrix(c(0.3,0.2,0.3,0.1,0.3,0.4,0.1,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.6),nrow=4)
ev4<-eigen(t(m4))
v4<-ev4$vectors[,1]
v4/sum(v4)
((0.2)^4)*(0.4)*(0.1)
((0.2083333)^3)*((0.333333)^2)*((0.25)^2)
((0.2)*(0.208333))/0.3333333
((0.2)*(0.2083333))/0.3333333
(0.1^3)*(0.2^2)*0.4
((0.2083333)^3)*((0.333333)^2)*((0.25)^2)
((0.2)^4)*(0.4)*(0.1)
(0.1^3)*(0.2^2)*0.4
library(rmarkdown)
library(knitr)
install.packages("tinytex")
library(tinytex)
install.packages("TinyTeX")
ire_100m_2019<-read.csv("/home/lukec/Documents/CT5100/ire-2019-100m-best.csv")
View(ire_100m_2019)
ire_100m_2019_f<-ire_100m_2019$competition=="Women"
ire_100m_2019_f<-subset(ire_100m_2019, competition=="Women")
View(ire_100m_2019_f)
install.packages("pwr")
ire_100m_2019_f
install.packages("dplyr")
library(tidyr)
View(ire_100m_2019_f)
ire_100m_2019_f_trim<-ire_100m_2019_f %>% arrange(desc(time)) %>% slice(1:10)
top_n(ire_100m_2019_f, 10, time())
top_n(ire_100m_2019_f, 10, time)
library(dplyr)
top_n(ire_100m_2019_f, 10, time())
top_n(ire_100m_2019_f, 10, time)
bottom_n(ire_100m_2019_f, 10, time)
slice(ire_100m_2019_f, 1:10)
top_10_f_2019<-slice(ire_100m_2019_f, 1:10)
top_10_f_2019
View(top_10_f_2019)
dotchart(top_10_f_2019)
dotchart(top_10_f_2019$time, labels=top_10_f_2019$name)
kable(top_10_f_2019)
top_10_f_2019_tbl<-kable(top_10_f_2019)
top_10_f_2019_tbl<-kable(head(top_10_f_2019, n=10))
install.packages("kableExtra")
library(ggplot2)
top_10_f_2019_tbl<-kable(head(top_10_f_2019, n=10))
View(top_10_f_2019)
.libpaths
.libpaths()
.libPaths()
.libPaths()
install.packages("/home/lukec/R/x86_64-pc-linux-gnu-library/4.2/4.1", repos=NULL, type="source")
install.packages("~/R/x86_64-pc-linux-gnu-library/4.2/R_packages.tar.gz", repos = NULL, type = "source")
.libPaths()
library(#)
exit
.Library
install.packages("~/R/x86_64-pc-linux-gnu-library/4.2/R_packages.tar.gz", repos = NULL, type = "source")
install.packages("ash")
install.packages("askpass")
install.packages("/home/lukec/R/x86_64-pc-linux-gnu-library/4.2/R_packages.tar.gz", repos=NULL, type="source")
.libPaths()
.Library
setwd("~/Documents/MA5112")
install.packages("dplyr")
.libPaths()
install.packages("dplyr", lib="/usr/lib/R/site-library")
install.packages("dplyr", lib="/usr/lib/R/site-library")
options(repos = c(CRAN = “http://cran.rstudio.com”))
options(repos = c(CRAN = "http://cran.rstudio.com”))
install.packages("dplyr")
options(repos = c(CRAN = "http://cran.rstudio.com”))
install.packages("ash")
